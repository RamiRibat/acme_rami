#!/bin/bash

#SBATCH --job-name=q_dmc_d4pg
#SBATCH --time=00:02:00

#SBATCH --open-mode=append
#SBATCH --qos=normal
#SBATCH --nodes=1
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH --cpus-per-gpu=12
#SBATCH --mem-per-gpu=8G

#SBATCH --output=/h/rahmed/logdir/slurm/output-%N-%j.out
#SBATCH --error=/h/rahmed/logdir/slurm/error-%N-%j.err

# echo "..Initialize.."

# put your command here

# bash script.sh

TASK_SUITES=(
    # 'gym'
    'control'
    # 'atari26'
    # 'atari52'
    # 'atari57'
)


DATETIME=$(date +'%Y%m%d:%H%M%S')

ID="vector_"$DATETIME

SEEDS=(2)

GPUS=(0)

source ~/.bashrc

conda activate acme

rm -f ~/logdir/vector.log

for SUITE in ${TASK_SUITES[*]}; do
    for i in ${!SEEDS[*]}; do
        echo "SEED " ${SEEDS[i]} >> ~/logdir/vector.log
        echo "CUDA " $CUDA_VISIBLE_DEVICES >> ~/logdir/vector.log
        # srun --exclusive --gres=gpu:1 --mem=8G echo "SUB_CUDA" $CUDA_VISIBLE_DEVICES >> ~/logdir/vector.log
        # srun --exclusive --gres=gpu:1 --mem=8G python run_d4pg.py --acme_id $ID --suite $SUITE --seed ${SEEDS[i]} >> ~/logdir/vector.log
        # CUDA_VISIBLE_DEVICES=${GPUS[i]} python run_d4pg.py --acme_id $ID --suite $SUITE --seed ${SEEDS[i]} >> ~/logdir/vector.log &
    done
done

wait

conda deactivate
